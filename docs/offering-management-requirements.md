# 헌금 관리 기능 요구사항 정의서

## 📋 문서 정보
- **작성일**: 2024-01-XX
- **버전**: 1.0
- **프로젝트**: ITTLC 교회 관리 시스템
- **담당자**: 개발팀

## 🎯 개요 및 목적

### 목적
교회 내 헌금 관리를 체계적으로 관리하고 추적할 수 있는 디지털 시스템을 구축하여 투명하고 효율적인 헌금 관리를 실현합니다.

### 배경
- 기존 수기/엑셀 기반 헌금 관리의 한계
- 헌금 내역 추적 및 통계 분석 필요성
- 성도별 헌금 이력 관리 요구
- 투명한 재정 관리 체계 구축

## 🏗️ 현재 시스템 구조

### 기존 메뉴 구조
```
├── 대시보드
├── 성도관리
│   ├── 성도 조회
│   ├── 성도 등록
│   └── 정보 수정
├── 기도
│   ├── 기도 제목
│   └── 기도 등록
└── 관리자
```

### 신규 추가 메뉴
```
└── 헌금 (NEW)
    ├── 헌금 조회
    └── 헌금 입력
```

## 🚀 신규 기능 요구사항

### 1. 헌금 대분류 추가
- **위치**: 메인 네비게이션 메뉴
- **순서**: 기도 메뉴 다음, 관리자 메뉴 이전
- **아이콘**: 💰 또는 기부 관련 아이콘
- **권한**: 사용자 역할에 따른 접근 제어

### 2. 헌금 조회 기능
- **경로**: `/main/offering/view`
- **목적**: 헌금 내역 조회 및 검색

### 3. 헌금 입력 기능
- **경로**: `/main/offering/input`
- **목적**: 새로운 헌금 내역 등록

## 📊 기능 상세 정의

### 헌금 조회 (Offering View)

#### 주요 기능
1. **헌금 내역 목록 조회**
   - 전체 헌금 내역 리스트 표시
   - 페이지네이션 처리
   - 정렬 기능 (날짜, 금액, 성도명)

2. **검색 및 필터링**
   - 날짜 범위 검색
   - 성도명 검색
   - 헌금 종류별 필터링
   - 금액 범위 검색

3. **통계 정보 표시**
   - 총 헌금액
   - 기간별 헌금 현황
   - 헌금 종류별 집계

#### 표시 정보
- 헌금 일자
- 성도명
- 헌금 종류 (십일조, 감사, 선교, 건축, 기타)
- 헌금 금액
- 메모/비고
- 등록자
- 등록 일시

### 헌금 입력 (Offering Input)

#### 주요 기능
1. **헌금 정보 입력**
   - 헌금 일자 선택
   - 성도 선택 (드롭다운/검색)
   - 헌금 종류 선택
   - 헌금 금액 입력
   - 메모 입력

2. **데이터 검증**
   - 필수 항목 체크
   - 금액 유효성 검증
   - 중복 등록 방지

3. **일괄 입력 지원**
   - 여러 성도 동시 입력
   - CSV/Excel 파일 업로드
   - 템플릿 다운로드

#### 입력 항목
- **헌금 일자** (필수)
- **성도명** (필수, 성도 DB 연동)
- **헌금 종류** (필수, 선택 옵션)
- **헌금 금액** (필수, 숫자만 입력)
- **메모** (선택사항, 최대 500자)

## 🗃️ 데이터 구조

### 헌금 테이블 (offerings)
```sql
CREATE TABLE offerings (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    member_id INTEGER NOT NULL,
    offering_date DATE NOT NULL,
    offering_type VARCHAR(50) NOT NULL,
    amount DECIMAL(10,2) NOT NULL,
    memo TEXT,
    created_by INTEGER NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (member_id) REFERENCES members(id),
    FOREIGN KEY (created_by) REFERENCES users(id)
);
```

### 헌금 종류 테이블 (offering_types)
```sql
CREATE TABLE offering_types (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name VARCHAR(50) NOT NULL UNIQUE,
    description TEXT,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### 기본 헌금 종류 데이터
- 십일조
- 감사헌금
- 선교헌금
- 건축헌금
- 특별헌금
- 기타

## 🎨 UI/UX 요구사항

### 헌금 조회 페이지
1. **헤더**
   - 페이지 제목: "헌금 조회"
   - 검색 필터 버튼
   - 엑셀 다운로드 버튼

2. **검색 필터**
   - 접이식 필터 영역
   - 날짜 범위 선택기
   - 성도명 검색 입력창
   - 헌금 종류 체크박스
   - 금액 범위 슬라이더

3. **데이터 테이블**
   - 반응형 테이블
   - 정렬 가능한 컬럼 헤더
   - 페이지네이션
   - 로딩 상태 표시

4. **통계 카드**
   - 총 헌금액 표시
   - 이번 달 헌금액
   - 전월 대비 증감률

### 헌금 입력 페이지
1. **폼 레이아웃**
   - 단일 입력 폼
   - 필수 항목 표시 (*)
   - 실시간 유효성 검사

2. **입력 컨트롤**
   - 날짜 선택기
   - 성도 자동완성 검색
   - 헌금 종류 셀렉트박스
   - 금액 입력 (천단위 콤마)
   - 메모 텍스트 영역

3. **버튼 그룹**
   - 저장 버튼
   - 취소 버튼
   - 초기화 버튼

## 🔐 권한 관리

### 역할별 접근 권한
1. **관리자 (Admin)**
   - 헌금 조회: 전체 접근
   - 헌금 입력: 전체 접근
   - 헌금 수정/삭제: 전체 접근

2. **사용자 (User)**
   - 헌금 조회: 조회만 가능
   - 헌금 입력: 입력만 가능
   - 헌금 수정/삭제: 제한

3. **게스트 (Guest)**
   - 헌금 관련 기능: 접근 불가

## 📊 개발 우선순위

### Phase 1 (고우선순위)
1. 헌금 데이터 모델 설계
2. 헌금 입력 기능 구현
3. 기본 헌금 조회 기능 구현
4. 메뉴 구조 업데이트

### Phase 2 (중우선순위)
1. 검색 및 필터링 기능
2. 통계 정보 표시
3. 데이터 검증 강화
4. 사용자 권한 관리

### Phase 3 (저우선순위)
1. 일괄 입력 기능
2. 파일 업로드/다운로드
3. 고급 통계 및 리포트
4. 모바일 최적화

## 🧪 테스트 요구사항

### 기능 테스트
1. 헌금 입력 정상 동작 확인
2. 헌금 조회 및 검색 기능 확인
3. 데이터 유효성 검증 확인
4. 권한별 접근 제어 확인

### 성능 테스트
1. 대용량 데이터 처리 성능
2. 검색 응답 시간 측정
3. 동시 사용자 처리 능력

### 보안 테스트
1. 데이터 접근 권한 확인
2. 입력 데이터 검증
3. SQL 인젝션 방지 확인

## 🚦 주의사항

### 보안 고려사항
- 헌금 정보는 민감한 개인정보로 처리
- 접근 로그 기록 필수
- 데이터 암호화 저장 고려

### 개발 고려사항
- 기존 성도 관리 시스템과의 연동
- 데이터 마이그레이션 계획 수립
- 백업 및 복구 전략 수립

### 운영 고려사항
- 사용자 교육 자료 준비
- 데이터 백업 주기 설정
- 정기적인 데이터 검증 프로세스

## 📝 참고사항

### 관련 문서
- [로그인 기능 개발 가이드](./login-feature-fix.md)
- [시스템 문제 해결 가이드](./troubleshooting.md)
- [프로젝트 전체 README](./README.md)

### 개발 일정
- 분석 및 설계: 1주
- 개발: 2-3주
- 테스트: 1주
- 배포 및 안정화: 1주

---

**문서 작성자**: 개발팀  
**최종 수정일**: 2024-01-XX  
**승인자**: 프로젝트 관리자 